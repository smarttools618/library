<!DOCTYPE html>
<html lang="ar" dir="rtl" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>المكتبة</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --ease-cubic: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
        }

        html[data-theme="light"] {
            --primary: #0066ff;
            --primary-dark: #0040cc;
            --primary-glow: linear-gradient(135deg, #0066ff 0%, #0040cc 100%);
            --background: #f0f2f5;
            --surface: #ffffff;
            --surface-secondary: #f8f9fc;
            --text-primary: #1c1e21;
            --text-secondary: #65676b;
            --border-color: #e0e2e7;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --glow-color: rgba(0, 102, 255, 0.15);
        }

        html[data-theme="dark"] {
            --primary: #2b8cff;
            --primary-dark: #0066ff;
            --primary-glow: linear-gradient(135deg, #2b8cff 0%, #0066ff 100%);
            --background: #18191a;
            --surface: #242526;
            --surface-secondary: #3a3b3c;
            --text-primary: #e4e6eb;
            --text-secondary: #b0b3b8;
            --border-color: #3e4042;
            --shadow-color: rgba(0, 0, 0, 0.4);
            --glow-color: rgba(43, 140, 255, 0.2);
        }
        
        /* --- Base & Layout --- */
        html { scroll-behavior: smooth; }
        body {
            background: var(--background);
            color: var(--text-primary);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding-top: 70px;
            transition: background 0.3s, color 0.3s;
        }
        .page-container { display: flex; }

        /* --- Top Header Bar --- */
        .top-bar {
            position: fixed; top: 0; left: 0; right: 0; height: 70px;
            background: var(--surface-transparent, rgba(255, 255, 255, 0.8));
            backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border-color);
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 24px; z-index: 1100;
            transition: background 0.3s, border-color 0.3s;
        }
        html[data-theme="dark"] .top-bar { --surface-transparent: rgba(36, 37, 38, 0.8); }

        .logo { display: flex; align-items: center; gap: 12px; color: var(--text-primary); text-decoration: none; }
        .logo-icon {
            background: var(--primary-glow);
            width: 44px; height: 44px; border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 12px var(--glow-color);
        }
        .logo-icon i { font-size: 1.5rem; color: #fff; }
        .logo-text { font-size: 1.5rem; font-weight: 800; }
        .header-controls { display: flex; align-items: center; gap: 16px; }
        .theme-toggle {
            font-size: 1.3rem; color: var(--text-secondary); background: none;
            border: none; cursor: pointer; padding: 8px;
            transition: color 0.2s, transform 0.2s;
        }
        .theme-toggle:hover { color: var(--primary); transform: scale(1.1) rotate(-15deg); }
        .theme-toggle .fa-sun { display: none; }
        html[data-theme="dark"] .theme-toggle .fa-sun { display: inline-block; }
        html[data-theme="dark"] .theme-toggle .fa-moon { display: none; }

        /* --- Right Sidebar --- */
        .sidebar {
            width: 250px; background: var(--surface);
            padding: 24px 0; height: calc(100vh - 70px);
            position: fixed; top: 70px; right: 0;
            overflow-y: auto; border-left: 1px solid var(--border-color);
            transition: transform 0.3s ease-in-out, background 0.3s, border-color 0.3s;
        }
        .filter-form { padding: 0 16px; }
        .filter-group { border: none; padding: 0; margin: 0 0 24px 0; }
        .filter-group legend {
            font-size: 0.9rem; text-transform: uppercase;
            color: var(--text-secondary); padding: 0 8px;
            margin-bottom: 12px; font-weight: 600;
        }
        .filter-options { display: flex; flex-direction: column; gap: 8px; }
        .filter-options input[type="radio"] { display: none; }
        .filter-options label {
            display: flex; align-items: center; gap: 12px;
            padding: 10px 16px; border-radius: 10px;
            cursor: pointer; font-weight: 500;
            transition: background 0.2s, color 0.2s;
        }
        .filter-options label:hover { background: var(--surface-secondary); }
        .filter-options input:checked + label {
            background: var(--primary-glow);
            color: #fff; font-weight: 700;
            box-shadow: 0 4px 10px var(--glow-color);
        }
        .filter-options i { width: 20px; text-align: center; }
        .filter-options input:checked + label i { color: #fff !important; }

        /* --- Main Content --- */
        .main-content { flex: 1; margin-right: 250px; padding: 32px; }
        .content-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; }
        .content-header h1 { font-size: 2rem; margin: 0; }
        .video-count-info { font-size: 1rem; font-weight: 500; color: var(--text-secondary); background: var(--surface); padding: 8px 16px; border-radius: 12px; border: 1px solid var(--border-color); }

        /* --- Video Card --- */
        .video-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 28px; }
        .video-card {
            background: var(--surface); border-radius: 18px;
            display: flex; flex-direction: column; cursor: pointer;
            transition: var(--ease-cubic);
            box-shadow: 0 2px 4px var(--shadow-color);
            border: 1px solid transparent;
        }
        .video-card:hover { transform: translateY(-8px); box-shadow: 0 8px 25px var(--shadow-color); }
        html[data-theme="dark"] .video-card:hover { border-color: var(--primary); }
        .video-thumbnail { position: relative; width: 100%; aspect-ratio: 16/9; border-radius: 18px 18px 0 0; overflow: hidden; }
        .video-thumbnail img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.4s ease; }
        .video-card:hover .video-thumbnail img { transform: scale(1.08); }
        .video-thumbnail-overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: flex; justify-content: center; align-items: center; background: rgba(0, 0, 0, 0.4); opacity: 0; transition: var(--ease-cubic); }
        .video-card:hover .video-thumbnail-overlay { opacity: 1; }
        .play-icon { font-size: 3rem; color: #fff; transform: scale(0.8); transition: var(--ease-cubic); }
        .video-card:hover .play-icon { transform: scale(1); }
        .video-duration { position: absolute; bottom: 8px; right: 8px; background: rgba(0, 0, 0, 0.75); color: #fff; padding: 2px 8px; border-radius: 6px; font-size: 0.8rem; font-weight: 600; }
        .video-info { padding: 16px; display: flex; gap: 12px; align-items: flex-start; }
        .category-icon { width: 40px; height: 40px; border-radius: 50%; background: var(--primary-glow); color: #fff; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; flex-shrink: 0; }
        .video-details { display: flex; flex-direction: column; min-width: 0; }
        .video-title { font-size: 1.05rem; font-weight: 600; line-height: 1.5; margin: 0 0 6px 0; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; }
        .video-meta { font-size: 0.85rem; color: var(--text-secondary); }
        .video-meta span { margin-left: 12px; }

        /* --- Enhanced No Results --- */
        .no-results {
            grid-column: 1 / -1;
            text-align: center; color: var(--text-secondary);
            padding: 60px 20px;
            background: var(--surface);
            border-radius: 18px;
            border: 2px dashed var(--border-color);
        }
        .no-results i { font-size: 3rem; margin-bottom: 16px; color: var(--primary); }
        .no-results p { font-size: 1.2rem; font-weight: 500; margin: 0; }
        
        /* --- Player Modal & Responsive --- */
        .player-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); z-index: 2000; display: flex; align-items: center; justify-content: center; opacity: 0; visibility: hidden; transition: opacity 0.3s, visibility 0.3s; }
        .player-modal.active { opacity: 1; visibility: visible; }
        .modal-content { background: var(--surface); border-radius: 18px; box-shadow: 0 15px 50px rgba(0,0,0,0.2); max-width: 900px; width: 90vw; position: relative; transform: scale(0.95); transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .player-modal.active .modal-content { transform: scale(1); }
        .close-btn { position: absolute; top: -15px; left: -15px; background: var(--surface); border: none; color: var(--text-primary); font-size: 1.2rem; z-index: 2; cursor: pointer; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px var(--shadow-color); transition: transform 0.2s, color 0.2s; }
        .close-btn:hover { transform: scale(1.1) rotate(90deg); color: var(--primary); }
        .player-container { width: 100%; aspect-ratio: 16/9; background: #000; border-radius: 18px 18px 0 0; overflow: hidden; }
        .player-container iframe { width: 100%; height: 100%; border: none; }
        #player-title { padding: 16px 20px; font-size: 1.2rem; font-weight: 600; border-top: 1px solid var(--border-color); }
        .sidebar-toggle { display: none; }
        @media (max-width: 1024px) {
            .logo-text { display: none; }
            .sidebar-toggle { display: block; }
            .sidebar { transform: translateX(100%); z-index: 1200; box-shadow: -5px 0 15px rgba(0,0,0,0.1); }
            .sidebar.is-open { transform: translateX(0); }
            .main-content { margin-right: 0; padding: 24px; }
            .overlay.is-visible { display: block; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.4); z-index: 1199; }
        }
    </style>
</head>
<body>

    <header class="top-bar">
        <div class="header-controls">
            <button class="sidebar-toggle" id="sidebar-toggle" aria-label="فتح القائمة"><i class="fas fa-bars"></i></button>
            <button class="theme-toggle" id="theme-toggle" title="تغيير المظهر">
                <i class="fas fa-moon"></i><i class="fas fa-sun"></i>
            </button>
        </div>
        
        <a href="#" class="logo" onclick="window.location.reload()">
            <div class="logo-text">المكتبة</div>
            <div class="logo-icon"><i class="fas fa-film"></i></div>
        </a>
    </header>

    <div class="page-container">
        <nav class="sidebar" id="sidebar">
            <form class="filter-form" id="filter-form">
                <fieldset class="filter-group" id="category-filters"></fieldset>
                <fieldset class="filter-group" id="lang-filters"></fieldset>
            </form>
        </nav>

        <main class="main-content">
            <div class="content-header">
                <h1 id="content-title">كل الوثائقيات</h1>
                <div class="video-count-info"><span id="video-count">0</span></div>
            </div>
            <div class="video-grid" id="video-grid"></div>
        </main>
    </div>
    
    <div class="overlay" id="overlay"></div>

    <div class="player-modal" id="player-modal">
        <div class="modal-content">
            <button class="close-btn" id="close-player-modal" title="إغلاق"><i class="fas fa-times"></i></button>
            <div class="player-container" id="player-container"></div>
            <h3 id="player-title"></h3>
        </div>
    </div>
    
    <script>
    const allDocumentaries = [
        // --- History ---
        { title: 'الخوف | أبُكاليبـس - الحرب العالمية الأولى', category: 'history', id: 'huyXH0lxpVM', lang: 'ar', embed: 'https://www.youtube-nocookie.com/embed/huyXH0lxpVM', duration: '45:12', views: '1.2M', uploadDate: '2023-05-10' },
        { title: 'المعركة النهائية لهتلر: الكتيبة المفقودة', category: 'history', id: 'lE2B6DdFZBI', lang: 'ar', embed: 'https://www.youtube-nocookie.com/embed/lE2B6DdFZBI', duration: '48:30', views: '875K', uploadDate: '2023-08-22' },
        { title: 'مصر القديمة: توت عنخ آمون الجبار', category: 'history', id: 'udE4ehMwChc', lang: 'ar', embed: 'https://www.youtube-nocookie.com/embed/udE4ehMwChc', duration: '52:05', views: '2.5M', uploadDate: '2024-01-15' },
        // --- Science (All 5 videos restored) ---
        { title: 'وثائقي | قوة الأفكار - لغز كبير يواجه العلم', category: 'science', id: 'ON7V2XiQFrM', lang: 'ar', embed: 'https://www.youtube-nocookie.com/embed/ON7V2XiQFrM', duration: '42:19', views: '980K', uploadDate: '2023-11-03' },
        { title: 'Discover The Mysteries of the Human Brain', category: 'science', id: 'GsWfGTTgntA', lang: 'en', embed: 'https://www.youtube-nocookie.com/embed/GsWfGTTgntA', duration: '59:01', views: '10M', uploadDate: '2022-09-01' },
        { title: 'How our brain judges people in a split second', category: 'science', id: 'XOfeqRgaF1A', lang: 'en', embed: 'https://www.youtube-nocookie.com/embed/XOfeqRgaF1A', duration: '28:44', views: '3.1M', uploadDate: '2023-03-18' },
        { title: 'ذكاء الحشرات - كيف يطور النحل مهارات معقدة؟', category: 'science', id: '46mIoIdGCDw', lang: 'ar', embed: 'https://www.youtube-nocookie.com/embed/46mIoIdGCDw', duration: '42:31', views: '450K', uploadDate: '2024-02-20' },
        { title: 'هل يتحدث البشر والحيتان نفس اللغة ؟', category: 'science', id: 'cTNguGH4XdY', lang: 'ar', embed: 'https://www.youtube-nocookie.com/embed/cTNguGH4XdY', duration: '15:23', views: '1.1M', uploadDate: '2024-04-05' },
        // --- Technology ---
        { title: 'السباق نحو الذكاء الاصطناعيّ', category: 'technology', id: 'EpW4j-3sPP4', lang: 'ar', embed: 'https://www.youtube-nocookie.com/embed/EpW4j-3sPP4', duration: '1:03:55', views: '4.7M', uploadDate: '2024-05-01' },
    ];

    document.addEventListener('DOMContentLoaded', function() {
        // --- Element Selectors ---
        const elements = {
            videoGrid: document.getElementById('video-grid'),
            videoCountEl: document.getElementById('video-count'),
            filterForm: document.getElementById('filter-form'),
            categoryFilters: document.getElementById('category-filters'),
            langFilters: document.getElementById('lang-filters'),
            playerModal: document.getElementById('player-modal'),
            playerContainer: document.getElementById('player-container'),
            playerTitle: document.getElementById('player-title'),
            closePlayerBtn: document.getElementById('close-player-modal'),
            themeToggle: document.getElementById('theme-toggle'),
            htmlEl: document.documentElement,
            sidebar: document.getElementById('sidebar'),
            overlay: document.getElementById('overlay'),
            sidebarToggle: document.getElementById('sidebar-toggle'),
        };

        const maps = {
            category: {
                all: { name: 'كل التصنيفات', icon: 'fa-grip' },
                history: { name: 'التاريخ', icon: 'fa-landmark' },
                science: { name: 'العلوم', icon: 'fa-flask' },
                technology: { name: 'التقنية', icon: 'fa-microchip' },
                geography: { name: 'الجغرافيا', icon: 'fa-globe-africa' },
                philosophy: { name: 'الفلسفة', icon: 'fa-brain' },
                arts: { name: 'الفنون', icon: 'fa-palette' },
            },
            lang: {
                all: { name: 'كل اللغات', icon: 'fa-language' },
                ar: { name: 'العربية', icon: 'fa-solid fa-a' },
                en: { name: 'English', icon: 'fa-solid fa-e' },
            }
        };

        // --- State ---
        let state = {
            category: 'all',
            lang: 'all'
        };

        // --- Functions ---
        const setupTheme = () => {
            const savedTheme = localStorage.getItem('theme') || 'light';
            elements.htmlEl.dataset.theme = savedTheme;
            elements.themeToggle.addEventListener('click', () => {
                const newTheme = elements.htmlEl.dataset.theme === 'light' ? 'dark' : 'light';
                elements.htmlEl.dataset.theme = newTheme;
                localStorage.setItem('theme', newTheme);
            });
        };

        const populateFilters = () => {
            const createOptions = (group, map) => {
                let html = `<legend>${group === 'category' ? 'التصنيف' : 'اللغة'}</legend><div class="filter-options">`;
                for (const [key, value] of Object.entries(map)) {
                    html += `
                        <input type="radio" id="${group}-${key}" name="${group}" value="${key}" ${key === 'all' ? 'checked' : ''}>
                        <label for="${group}-${key}"><i class="fas ${value.icon}"></i> ${value.name}</label>
                    `;
                }
                html += `</div>`;
                return html;
            };
            elements.categoryFilters.innerHTML = createOptions('category', maps.category);
            elements.langFilters.innerHTML = createOptions('lang', maps.lang);
        };

        const filterAndRender = () => {
            const filtered = allDocumentaries.filter(doc =>
                (state.category === 'all' || doc.category === state.category) &&
                (state.lang === 'all' || doc.lang === state.lang)
            );
            renderVideos(filtered);
        };
        
        const renderVideos = (docs) => {
            elements.videoGrid.innerHTML = '';
            elements.videoCountEl.textContent = `${docs.length} وثائقي`;
            if (docs.length === 0) {
                elements.videoGrid.innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-video-slash"></i>
                        <p>لا توجد نتائج تطابق الفلاتر المختارة.</p>
                    </div>`;
                return;
            }

            docs.forEach(doc => {
                const card = document.createElement('div');
                card.className = 'video-card';
                card.innerHTML = `
                    <div class="video-thumbnail">
                        <img src="https://i.ytimg.com/vi/${doc.id}/hqdefault.jpg" alt="${doc.title}" loading="lazy">
                        <div class="video-thumbnail-overlay"><i class="fas fa-play play-icon"></i></div>
                        <span class="video-duration">${doc.duration}</span>
                    </div>
                    <div class="video-info">
                        <div class="category-icon"><i class="fas ${maps.category[doc.category].icon}"></i></div>
                        <div class="video-details">
                            <h3 class="video-title">${doc.title}</h3>
                            <div class="video-meta">${doc.views} مشاهدة <span>•</span> ${doc.uploadDate}</div>
                        </div>
                    </div>`;
                card.addEventListener('click', () => openPlayerModal(doc));
                elements.videoGrid.appendChild(card);
            });
        };

        const openPlayerModal = (doc) => {
            elements.playerContainer.innerHTML = `<iframe src="${doc.embed}?autoplay=1&rel=0" title="${doc.title}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
            elements.playerTitle.textContent = doc.title;
            elements.playerModal.classList.add('active');
            document.body.style.overflow = 'hidden';
        };

        const closePlayerModal = () => {
            elements.playerContainer.innerHTML = '';
            elements.playerModal.classList.remove('active');
            document.body.style.overflow = '';
        };
        
        const setupMobileNav = () => {
            elements.sidebarToggle.addEventListener('click', () => {
                elements.sidebar.classList.toggle('is-open');
                elements.overlay.classList.toggle('is-visible');
            });
            elements.overlay.addEventListener('click', () => {
                elements.sidebar.classList.remove('is-open');
                elements.overlay.classList.remove('is-visible');
            });
        };

        // --- Initialization ---
        function init() {
            setupTheme();
            populateFilters();
            filterAndRender();
            setupMobileNav();

            elements.filterForm.addEventListener('change', (e) => {
                const formData = new FormData(elements.filterForm);
                state.category = formData.get('category');
                state.lang = formData.get('lang');
                filterAndRender();
            });

            elements.closePlayerBtn.addEventListener('click', closePlayerModal);
            elements.playerModal.addEventListener('click', (e) => e.target === elements.playerModal && closePlayerModal());
            document.addEventListener('keydown', (e) => e.key === 'Escape' && elements.playerModal.classList.contains('active') && closePlayerModal());
        }

        init();
    });
    </script>
</body>
</html>